# API Contract: Educational ROS 2 Simulator

## Overview
This API contract defines the educational interface that students will learn to work with when studying ROS 2 concepts. It represents a simplified simulation environment that demonstrates ROS 2 nodes, topics, services, and parameters without requiring actual ROS 2 installation.

## Base URL
```
https://edu-ros2-simulator.example.com/api/v1
```

## Authentication
No authentication required for educational purposes.

## Common Headers
```
Content-Type: application/json
Accept: application/json
```

## Endpoints

### 1. Node Management

#### GET /nodes
List all active nodes in the simulated ROS 2 system.

**Response (200 OK):**
```json
{
  "nodes": [
    {
      "id": "node_123",
      "name": "talker_node",
      "type": "publisher",
      "topics": ["/chatter"],
      "status": "active"
    },
    {
      "id": "node_456", 
      "name": "listener_node",
      "type": "subscriber",
      "topics": ["/chatter"],
      "status": "active"
    }
  ]
}
```

#### POST /nodes
Create a new simulated node.

**Request:**
```json
{
  "name": "my_new_node",
  "type": "publisher",
  "topics": ["/new_topic"],
  "parameters": {}
}
```

**Response (201 Created):**
```json
{
  "id": "node_789",
  "name": "my_new_node",
  "type": "publisher",
  "topics": ["/new_topic"],
  "status": "active",
  "created_at": "2025-12-09T10:00:00Z"
}
```

### 2. Topic Communication

#### GET /topics
List all available topics in the simulated system.

**Response (200 OK):**
```json
{
  "topics": [
    {
      "name": "/chatter",
      "type": "std_msgs/String",
      "publishers": 1,
      "subscribers": 1
    },
    {
      "name": "/robot_status",
      "type": "std_msgs/Bool", 
      "publishers": 1,
      "subscribers": 3
    }
  ]
}
```

#### POST /topics/{topic_name}/publish
Publish a message to a topic.

**Path Parameters:**
- `topic_name`: The name of the topic (e.g. "/chatter")

**Request:**
```json
{
  "node_id": "node_123",
  "data": {
    "data": "Hello, ROS 2!"
  }
}
```

**Response (200 OK):**
```json
{
  "status": "published",
  "timestamp": "2025-12-09T10:05:00Z",
  "topic": "/chatter",
  "message_id": "msg_001"
}
```

#### GET /topics/{topic_name}/messages
Get recent messages from a topic (simulated subscription).

**Path Parameters:**
- `topic_name`: The name of the topic

**Query Parameters:**
- `limit` (optional): Number of messages to return (default: 10)

**Response (200 OK):**
```json
{
  "topic": "/chatter",
  "messages": [
    {
      "id": "msg_001",
      "timestamp": "2025-12-09T10:00:00Z",
      "publisher": "talker_node",
      "data": {
        "data": "Hello, ROS 2!"
      }
    }
  ]
}
```

### 3. Services

#### GET /services
List all available services in the simulated system.

**Response (200 OK):**
```json
{
  "services": [
    {
      "name": "/add_two_ints",
      "type": "example_interfaces/AddTwoInts",
      "clients": 1,
      "servers": 1
    }
  ]
}
```

#### POST /services/{service_name}/call
Call a service and get a response.

**Path Parameters:**
- `service_name`: The name of the service (e.g. "/add_two_ints")

**Request:**
```json
{
  "a": 10,
  "b": 20
}
```

**Response (200 OK):**
```json
{
  "success": true,
  "result": {
    "sum": 30
  },
  "timestamp": "2025-12-09T10:10:00Z"
}
```

### 4. Robot Model Management

#### GET /robots
List available robot models in the simulation.

**Response (200 OK):**
```json
{
  "robots": [
    {
      "id": "robot_001",
      "name": "simple_humanoid",
      "urdf": "simple_humanoid.urdf",
      "links": 5,
      "joints": 4
    }
  ]
}
```

#### GET /robots/{robot_id}/model
Get the URDF representation of a robot.

**Path Parameters:**
- `robot_id`: The ID of the robot

**Response (200 OK):**
```json
{
  "id": "robot_001",
  "name": "simple_humanoid",
  "urdf": "<robot name='simple_humanoid'>\n  <link name='base_link'/>\n  <link name='head'/>\n  <joint name='head_joint' type='revolute'>\n    <parent link='base_link'/>\n    <child link='head'/>\n  </joint>\n</robot>",
  "links": [
    { "name": "base_link", "type": "fixed" },
    { "name": "head", "type": "movable" }
  ],
  "joints": [
    { "name": "head_joint", "type": "revolute", "parent": "base_link", "child": "head" }
  ]
}
```

## Error Responses

All error responses follow this format:

**400 Bad Request:**
```json
{
  "error": "invalid_request",
  "message": "The request was invalid or malformed",
  "details": "Additional error details"
}
```

**404 Not Found:**
```json
{
  "error": "resource_not_found",
  "message": "The requested resource was not found"
}
```

**500 Internal Server Error:**
```json
{
  "error": "internal_error",
  "message": "An internal server error occurred"
}
```

## Data Models

### Node
- `id`: string, unique identifier
- `name`: string, human-readable name
- `type`: string, either "publisher", "subscriber", "service_client", or "service_server"
- `topics`: array of strings, topics the node interacts with
- `status`: string, either "active", "inactive", or "error"
- `created_at`: string, ISO 8601 timestamp

### Topic
- `name`: string, topic identifier
- `type`: string, message type identifier
- `publishers`: integer, count of publishers
- `subscribers`: integer, count of subscribers

### Service
- `name`: string, service identifier
- `type`: string, service type identifier
- `clients`: integer, count of clients
- `servers`: integer, count of servers

### Robot
- `id`: string, unique identifier
- `name`: string, human-readable name
- `urdf`: string, URDF representation
- `links`: integer, count of links
- `joints`: integer, count of joints